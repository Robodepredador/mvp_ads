<section class="programacion">
  <aside class="panel cola">
    <header>
      <div>
        <p class="eyebrow">Cola de atención</p>
        <h2>Requerimientos</h2>
      </div>
      <button mat-stroked-button color="primary" (click)="cargarRequerimientos()" [disabled]="cargando">
        <mat-icon>refresh</mat-icon>
        Refrescar
      </button>
    </header>

    <div class="req-list-container">
      <div class="metrics">
        <div>
          <p>Pendientes</p>
          <strong>{{ pendientes }}</strong>
        </div>
        <div>
          <p>Parciales</p>
          <strong>{{ parciales }}</strong>
        </div>
        <div>
          <p>Programados</p>
          <strong>{{ programados }}</strong>
        </div>
      </div>

      <div *ngIf="!requerimientos.length && !cargando" class="empty">
        No se encontraron requerimientos.
      </div>

      <ul class="req-list" *ngIf="requerimientos.length">
        <li *ngFor="let req of requerimientos" [class.activo]="req.id === requerimiento?.id"
          (click)="verDetalle(req.id)">
          <div class="req-info">
            <strong>#{{ req.id }}</strong>
            <span class="estado" [ngClass]="req.estado?.toLowerCase()">{{ req.estado }}</span>
          </div>
          <small>Detalles: {{ req.detalles?.length || 0 }}</small>
        </li>
      </ul>

      <div class="guidance">
        <h3>Cómo priorizar</h3>
        <ol>
          <li>Empieza por los requerimientos con más productos pendientes.</li>
          <li>Decide primero los productos con inventario disponible.</li>
          <li>Registra compras sólo cuando no exista stock asignable.</li>
        </ol>
      </div>
    </div>
  </aside>

  <section class="panel detalle">
    <ng-container *ngIf="requerimiento; else emptyDetalle">
      <header>
        <div>
          <p class="eyebrow">Detalle</p>
          <h2>Requerimiento #{{ requerimiento.id }}</h2>
          <p>El detalle aparecerá aquí para que tomes decisiones de distribución o compra.</p>
        </div>
        </ng-template>
  </section>
</section>

<div class="mensaje toast" *ngIf="mensaje">{{ mensaje }}</div>